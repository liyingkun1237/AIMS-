## 4.6 CcxAdaboost

#### CcxAaboost算法原理

​	Adaboost是一种迭代算法，其核心思想是针对同一个训练集训练不同的分类器(弱分类器)，然后把这些弱分类器集合起来，构成一个更强的最终分类器(强分类器)。其算法本身是通过改变数据分布来实现的，它根据每次训练集之中每个样本的分类是否正确，以及上次的总体分类的准确率，来确定每个样本的权值。将修改过权值的新数据集送给下层分类器进行训练，同时，根据各分类器在样本集上的误差率计算相应的权重，使得分类误差率小的弱分类器的权重较大，反之，误差率大的弱分类器权重较小。最后将每次训练得到的分类器加权融合起来，作为最后的决策分类器。

算法的基本流程如下：

1） 初始化训练数据的权值分布，为每一个样本赋予相同权值：![img](function_tools/wps81E8.tmp.png)，训练样本集上的分布![img](function_tools/wps81E9.tmp.png)：![img](function_tools/wps81F9.tmp.png)；

2） 进行迭代t=1,…,T，选取当前误差率最低的一个弱分类器h作为第t个基本分类器Ht，并计算弱分类器Ht：![img](function_tools/wps81FA.tmp.png)，该弱分类器在分布上![img](function_tools/wps820B.tmp.png)的误差为：![img](function_tools/wps820C.tmp.png)；

3） 计算该弱分类器在最终分类器中所占的权重：![img](function_tools/wps821C.tmp.png)；

4） 更新训练样本的权值分布![img](function_tools/wps821D.tmp.png)：![img](function_tools/wps821E.tmp.png)，其中![img](file:///C:\Users\何博睿\AppData\Local\Temp\ksohtml\wps822F.tmp.png)为归一化常数![img](function_tools/wps8230.tmp.png)；

5） 最后，按弱分类器权值![img](function_tools/wps8241.tmp.png)组合各个弱分类器，通过符号函数sign得到一个强分类器：![img](function_tools/wps8242.tmp.png)。

#### CcxAdaboost使用建议

- Adaboost算法作为分类器时，有很高的分类准确率，且不需要做特征筛选，算法不容易发生过拟合现象。

- 在Adaboost算法框架下，可以使用各种回归分类模型来构建弱学习器，非常的灵活。但弱分类器数目不太好设定，需要采用交叉验证来确定。

- Adaboost算法对异常样本数据敏感，异常样本在迭代中可能获得较高的权重，影响最终的预测效果。

#### CcxAdaboost模型超参数设置

- **数据划分**：系统提供了分层抽样和随机抽样两种数据划分方法；

- **测试集比例**：用于分配模型训练中训练样本与测试样本的比例；

- **n_estimators**：万象智模平台默认值100，取值范围[1,inf]，最大的基学习器的个数取值太小，容易欠拟合，取值太大，计算量会太大，并且最大的基学习器的个数到一定的数量后，再增大其取值获得的模型提升会很小，所以一般选择一个适中的数值。而在实际调参过程中，常常与learning_rate一起考虑。

- **learning_rate**：万象智模平台默认值0.1，取值范围[0,1]，建议取值0.01-0.3。学习率通过减少每一步的权重，提高模型的鲁棒性。对于同样的训练集拟合效果，较小的步长意味着需要更多的迭代次数。通常采用learning_rate和n_estimators共同进行调参，一起决定算法的拟合效果。

- **algorithm**：万象智模平台提供有SAMME和SAMME.R两种算法，两者的主要区别是弱学习器权重的度量方式不同，SAMME使用对样本集即用对样本集分类效果作为弱学习器权重，而SAMME.R使用对样本集分类的预测概率大小来作为弱学习器权重。由于SAMME.R使用了概率度量的连续值，迭代一般比SAMME快，因此默认算法algorithm的值也是SAMME.R。我们一般使用默认的SAMME.R就够了，但是要注意的是使用了SAMME.R，则弱分类学习器必须限制使用支持概率预测的分类器，SAMME算法则没有这个限制。

- **寻优策略**

  - **init_points**：万象智模平台默认值为2，确定寻优方式后，算法对应的模型超参数组合的初始个数。

  - **num_iter**：万象智模平台默认值为5，寻优算法的迭代次数。

- **最优选择指标**

  - **测试集auc最优**：最优模型选择标准为测试集上模型的评估指标auc最大。

  - **测试集/训练集auc综合最优**：最优模型选择标准为综合测试集和训练集上模型的评估指标auc最大。